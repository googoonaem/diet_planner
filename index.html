<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>한달 다이어트 플랜</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
        background: #f9f9f9;
      }
      h1 {
        text-align: center;
      }
      .week-tabs {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-bottom: 20px;
      }
      .week-tabs button {
        padding: 8px 16px;
        cursor: pointer;
        border: 1px solid #ccc;
        background: #eee;
      }
      .week-tabs button.active {
        background: #333;
        color: white;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 10px;
      }
      th,
      td {
        padding: 8px;
        border: 1px solid #ccc;
        text-align: center;
        background: white;
      }
      td:has(input[type="checkbox"]) {
        /* 스타일 작성 */
        width: 50px;
        height: 50px;
        padding: 0;
        text-align: center;
        vertical-align: middle;
      }
      th:has(input[type="checkbox"]) {
        /* 스타일 작성 */
        width: 50px;
        height: 50px;
        padding: 0;
        text-align: center;
        vertical-align: middle;
      }
      tr:hover {
        background: #f0f8ff;
        cursor: pointer;
      }
      .detail-box {
        background: #fff;
        border: 1px solid #aaa;
        padding: 15px;
        display: none;
        margin-top: 10px;
      }
      td input[type="checkbox"],
      th input[type="checkbox"] {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        cursor: pointer;
        display: block;
      }
    </style>
  </head>
  <body>
    <h1>다이어트 플랜</h1>
    <div class="week-tabs">
      <button onclick="showWeek(1)" class="active">1주차</button>
      <button onclick="showWeek(2)">2주차</button>
      <button onclick="showWeek(3)">3주차</button>
      <button onclick="showWeek(4)">4주차</button>
    </div>
    <div id="tables-container">
      <!-- 각 주차별 테이블은 JS에서 삽입 -->
    </div>
    <div class="detail-box" id="detailBox"></div>
    <div style="max-width: 600px; margin: 20px auto">
      <h2>매일 숫자 입력</h2>
      <input type="date" id="inputDate" />
      <input type="number" id="inputValue" placeholder="값 입력" />
      <button id="saveBtn">저장</button>

      <canvas
        id="lineChart"
        width="600"
        height="300"
        style="background: #fff; border: 1px solid #ccc; margin-top: 20px"
      ></canvas>
    </div>

    <script>
      const inputDate = document.getElementById("inputDate");
      const inputValue = document.getElementById("inputValue");
      const saveBtn = document.getElementById("saveBtn");
      const canvas = document.getElementById("lineChart");
      const ctx = canvas.getContext("2d");

      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, "0");
      const dd = String(today.getDate()).padStart(2, "0");
      inputDate.value = `${yyyy}-${mm}-${dd}`;
      function getData() {
        const raw = localStorage.getItem("dailyNumbers");
        return raw ? JSON.parse(raw) : {};
      }

      function saveData(date, value) {
        const data = getData();
        data[date] = value;
        localStorage.setItem("dailyNumbers", JSON.stringify(data));
      }

      function drawChart() {
        const data = getData();
        const dates = Object.keys(data).sort();
        if (dates.length === 0) {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.fillText("데이터 없음", canvas.width / 2 - 30, canvas.height / 2);
          return;
        }

        // 그래프 그리기 기본 세팅
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.strokeStyle = "#0077cc";
        ctx.lineWidth = 2;
        ctx.fillStyle = "#000";
        ctx.font = "12px sans-serif";

        // 좌표계 여백
        const padding = 40;
        const w = canvas.width - padding * 2;
        const h = canvas.height - padding * 2;

        // 값 범위 계산
        const values = dates.map((d) => Number(data[d]));
        const maxVal = Math.max(...values);
        const minVal = Math.min(...values);

        // x축: 날짜 간격 균등 배치
        // y축: 값 범위에 맞게 비율 조절
        ctx.beginPath();
        dates.forEach((date, i) => {
          const x = padding + (w / (dates.length - 1)) * i;
          const y =
            padding + h - ((values[i] - minVal) / (maxVal - minVal || 1)) * h;
          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
          // 점 찍기
          ctx.fillRect(x - 3, y - 3, 6, 6);

          // 날짜 라벨
          ctx.fillText(date.slice(5), x - 15, canvas.height - 10);
        });
        ctx.stroke();

        // y축 라벨 (최댓값, 최솟값)
        ctx.fillText(maxVal, 5, padding + 10);
        ctx.fillText(minVal, 5, padding + h);
      }

      saveBtn.addEventListener("click", () => {
        const date = inputDate.value;
        const value = inputValue.value;
        if (!date || !value) {
          alert("날짜와 값을 모두 입력하세요.");
          return;
        }
        saveData(date, Number(value));
        drawChart();
        inputValue.value = "";
      });

      drawChart();

      const tablesContainer = document.getElementById("tables-container");
      const detailBox = document.getElementById("detailBox");

      const plans = {
        week1: [
          {
            day: "월요일",
            food: {
              short: "일반식 절반 + 채소",
              detail: `
        <strong>아침:</strong> 백미/잡곡밥 반공기, 계란 1개, 나물 조금<br>
        <strong>점심:</strong> 고기나 생선 1/2인분, 나물/샐러드 많이, 된장국<br>
        <strong>저녁:</strong> 잡곡밥, 채소볶음, 두부 반찬
      `,
              alt: "곤약밥, 닭가슴살 도시락",
            },
            exercise: {
              short: "스트레칭 10분",
              detail: "전신 스트레칭: 목, 어깨, 허리, 다리 위주로 10분",
              alt: "요가 앱 따라하기",
            },
            habit: {
              short: "물 1.5L 마시기",
              detail:
                "아침 기상 직후 1컵 + 식사 전후 + 오후 집중력 저하 시 1컵씩",
              alt: "허브티, 무가당 차",
            },
          },
          {
            day: "화요일",
            food: {
              short: "단백질 위주 식사",
              detail: `
        <strong>아침:</strong> 삶은 계란 2개, 그릭 요거트<br>
        <strong>점심:</strong> 닭가슴살, 삶은 브로콜리, 고구마<br>
        <strong>저녁:</strong> 두부 스테이크, 샐러드, 병아리콩
      `,
              alt: "두부, 그릭요거트, 병아리콩",
            },
            exercise: {
              short: "실내 걷기 20분",
              detail: "유튜브 실내 워킹 영상 따라하기",
              alt: "제자리 걷기, 댄스핏",
            },
            habit: {
              short: "야식 금지",
              detail: "저녁 7시 이후 금식, 허기지면 따뜻한 물 or 무카페인차",
              alt: "핫팩 배에 대고 잠들기",
            },
          },
          {
            day: "수요일",
            food: {
              short: "채식 위주",
              detail: `
        <strong>아침:</strong> 잡곡밥, 된장국, 나물반찬<br>
        <strong>점심:</strong> 채식 비빔밥, 샐러드<br>
        <strong>저녁:</strong> 채소 스튜, 두부구이
      `,
              alt: "채식 비빔밥, 샐러드볼",
            },
            exercise: {
              short: "가벼운 근력운동",
              detail: "스쿼트 10회 x 3세트, 팔굽혀펴기 무릎대고 10회 x 2",
              alt: "물병 아령, 의자운동",
            },
            habit: {
              short: "천천히 먹기",
              detail: "한입에 20번 이상 씹기, 20분 이상 식사",
              alt: "타이머 맞추고 식사",
            },
          },
          {
            day: "목요일",
            food: {
              short: "일반식 절반 + 채소",
              detail: `
        <strong>아침:</strong> 현미밥, 김치 조금<br>
        <strong>점심:</strong> 화,수 반복 식단 변형 (소고기 불고기 or 두부 스테이크)<br>
        <strong>저녁:</strong> 샐러드 또는 밀프랩 도시락 활용
      `,
              alt: "밀프랩 도시락 활용",
            },
            exercise: {
              short: "스트레칭 + 워킹",
              detail: "스트레칭 5분 + 실내 걷기 10분",
              alt: "가벼운 춤 영상",
            },
            habit: {
              short: "일찍 자기",
              detail: "23시 이전 취침 시 공복 유지 쉬움",
              alt: "블루라이트 차단 필터",
            },
          },
          {
            day: "금요일",
            food: {
              short: "간헐적 단식 시작",
              detail: `
        <strong>아침:</strong> 금식<br>
        <strong>점심:</strong> 점심부터 저녁까지만 식사 (8시간 이내), 물/차 허용<br>
        <strong>저녁:</strong> 고단백 식사 위주
      `,
              alt: "12:12 루틴으로 완화",
            },
            exercise: {
              short: "걷기 20분",
              detail: "집 안/밖 실천 자유",
              alt: "계단 오르기",
            },
            habit: {
              short: "체중 기록 시작",
              detail: "아침 기상 직후 소변 후 기록",
              alt: "앱 사용: 다이어트 플래너",
            },
          },
          {
            day: "토요일",
            food: {
              short: "단백질+채소",
              detail: `
        <strong>아침:</strong> 삶은 달걀 2개, 과일 조금<br>
        <strong>점심:</strong> 구운 고기, 생채소 또는 데친 야채<br>
        <strong>저녁:</strong> 쌈 채소, 된장, 삶은 달걀
      `,
              alt: "쌈 채소+된장+삶은달걀",
            },
            exercise: {
              short: "스트레칭 15분",
              detail: "어깨, 허리, 다리 중심으로 풀어주기",
              alt: "요가 or 필라테스 영상",
            },
            habit: {
              short: "모바일 시간 줄이기",
              detail: "1시간 단위로 알림 설정 후 사용 제한",
              alt: "타이머 앱 사용",
            },
          },
          {
            day: "일요일",
            food: {
              short: "자유식(조절)",
              detail: `
        <strong>아침:</strong> 가벼운 샐러드 또는 과일<br>
        <strong>점심:</strong> 평소 클린식 유지, 단백질 위주 식사<br>
        <strong>저녁:</strong> 배달 시 단백질 메뉴 중심으로 선택
      `,
              alt: "가벼운 샐러드, 닭가슴살 도시락",
            },
            exercise: {
              short: "쉬는 날",
              detail: "몸을 쉬게 해주되, 스트레칭은 해도 좋음",
              alt: "산책 10분",
            },
            habit: {
              short: "리셋 & 계획",
              detail: "지난주 돌아보기 + 다음주 준비",
              alt: "노션/캘린더 정리",
            },
          },
        ],
        week2: [
          {
            day: "월요일",
            food: {
              short: "저탄수 일반식",
              detail: `
      <strong>아침:</strong> 스크램블에그, 구운 토마토<br>
      <strong>점심:</strong> 닭가슴살, 샐러드, 삶은 달걀<br>
      <strong>저녁:</strong> 버섯볶음, 현미밥, 미역국
    `,
              alt: "현미곤약밥 도시락",
            },
            exercise: {
              short: "요가 20분",
              detail: "초급 요가 루틴: 유튜브 '아드리안 요가'",
              alt: "스트레칭 + 호흡운동",
            },
            habit: {
              short: "정리정돈",
              detail: "아침에 침대 정리, 책상 정리, 눈에 보이는 정돈 습관",
              alt: "15분 타이머 맞추고 정리",
            },
          },
          {
            day: "화요일",
            food: {
              short: "채식 기반 식사",
              detail: `
      <strong>아침:</strong> 두유, 통밀빵, 샐러드<br>
      <strong>점심:</strong> 채식 샌드위치, 과일<br>
      <strong>저녁:</strong> 야채볶음밥, 두부
    `,
              alt: "채식 컵밥, 콩고기 도시락",
            },
            exercise: {
              short: "하체 근력운동",
              detail: "스쿼트 15회 x 3세트, 런지 10회 x 3세트",
              alt: "계단 오르기 5층 x 2",
            },
            habit: {
              short: "체중 확인",
              detail: "공복 상태에서 아침 기록, 일간 변화를 체크",
              alt: "체중 기록 앱 연동",
            },
          },
          {
            day: "수요일",
            food: {
              short: "잡곡+채소 위주",
              detail: `
      <strong>아침:</strong> 오트밀 + 견과류 + 바나나<br>
      <strong>점심:</strong> 잡곡밥, 버섯불고기, 나물<br>
      <strong>저녁:</strong> 삶은 달걀, 토마토, 미역국
    `,
              alt: "오트밀 쉐이크, 채소볶음밥",
            },
            exercise: {
              short: "상체 스트레칭",
              detail: "어깨, 팔, 목 풀어주기 – 각 1분씩 3회 반복",
              alt: "폼롤러 사용",
            },
            habit: {
              short: "명상 5분",
              detail: "아침/저녁 중 택1, 호흡에 집중",
              alt: "명상 앱 활용",
            },
          },
          {
            day: "목요일",
            food: {
              short: "일반식 절반 + 단백질",
              detail: `
      <strong>아침:</strong> 잡곡밥 반공기, 계란프라이<br>
      <strong>점심:</strong> 생선구이, 나물, 김<br>
      <strong>저녁:</strong> 두부조림, 샐러드
    `,
              alt: "닭가슴살 도시락",
            },
            exercise: {
              short: "실내 유산소 20분",
              detail: "워밍업 후 제자리걷기 + 팔벌려뛰기 + 스텝박스 활용",
              alt: "댄스 유튜브 영상",
            },
            habit: {
              short: "디지털 디톡스",
              detail: "저녁 8시 이후 휴대폰 사용 중단",
              alt: "기기 비행기 모드",
            },
          },
          {
            day: "금요일",
            food: {
              short: "간헐적 단식",
              detail: `
      <strong>아침:</strong> 금식<br>
      <strong>점심:</strong> 현미밥, 고등어구이, 나물<br>
      <strong>저녁:</strong> 닭가슴살, 샐러드
    `,
              alt: "16:8 단식 루틴 적용",
            },
            exercise: {
              short: "산책 30분",
              detail: "빠르게 걷기 or 주변 공원 산책",
              alt: "러닝머신 걷기",
            },
            habit: {
              short: "수면 기록",
              detail: "취침 시간, 수면 질을 매일 기록",
              alt: "수면 앱 사용",
            },
          },
          {
            day: "토요일",
            food: {
              short: "클린 자유식",
              detail: `
      <strong>아침:</strong> 바나나 + 그릭요거트<br>
      <strong>점심:</strong> 치킨샐러드, 구운 고구마<br>
      <strong>저녁:</strong> 채소죽 또는 미음
    `,
              alt: "클린 도시락 자유 구성",
            },
            exercise: {
              short: "홈트 영상 따라하기",
              detail: "유튜브 15~20분 루틴 – 전신 or 복부",
              alt: "인스타 운동 릴스",
            },
            habit: {
              short: "소비 기록",
              detail: "그날 소비 내역 기록 및 분석",
              alt: "지출 가계부 앱",
            },
          },
          {
            day: "일요일",
            food: {
              short: "자유식 (단, 과식 금지)",
              detail: `
      <strong>아침:</strong> 과일, 견과류<br>
      <strong>점심:</strong> 외식 시 절반만 먹기<br>
      <strong>저녁:</strong> 과일+샐러드 또는 생략
    `,
              alt: "외식 반식 + 물 많이",
            },
            exercise: {
              short: "스트레칭 10분",
              detail: "허리, 골반 위주, 좌식 중심으로 가볍게",
              alt: "폼롤러 or 마사지볼",
            },
            habit: {
              short: "주간 피드백",
              detail: "이번 주 실천 점검 + 다음 주 수정 계획",
              alt: "다이어리 작성",
            },
          },
        ],
        wee3: [
          {
            day: "월요일",
            food: {
              short: "채소 + 단백질 중심",
              detail: `
        <strong>아침:</strong> 삶은 달걀, 오이, 토마토<br>
        <strong>점심:</strong> 닭가슴살, 브로콜리, 고구마<br>
        <strong>저녁:</strong> 야채스프, 두부
      `,
              alt: "닭가슴살 샐러드 도시락",
            },
            exercise: {
              short: "복부 코어운동",
              detail: "플랭크 30초 x 3세트, 레그레이즈, 크런치",
              alt: "복근 루틴 앱 따라하기",
            },
            habit: {
              short: "아침 일기",
              detail: "하루 목표 3가지 적기",
              alt: "5줄 요약 일기",
            },
          },
          {
            day: "화요일",
            food: {
              short: "간단한 일반식",
              detail: `
        <strong>아침:</strong> 바나나, 땅콩버터, 두유<br>
        <strong>점심:</strong> 김치볶음밥 반공기, 계란프라이<br>
        <strong>저녁:</strong> 채소전, 된장국
      `,
              alt: "간단 한식 정식 도시락",
            },
            exercise: {
              short: "하체 스트레칭",
              detail: "햄스트링, 종아리, 고관절 중심",
              alt: "요가 하체 루틴",
            },
            habit: {
              short: "물 2L 마시기",
              detail: "시간 정해서 500ml씩 나눠 마시기",
              alt: "물 알람 앱 사용",
            },
          },
          {
            day: "수요일",
            food: {
              short: "간헐적 단식 + 일반식",
              detail: `
        <strong>아침:</strong> 금식<br>
        <strong>점심:</strong> 곤약볶음밥, 계란찜<br>
        <strong>저녁:</strong> 연어 샐러드
      `,
              alt: "곤약도시락 + 샐러드",
            },
            exercise: {
              short: "상체 근력",
              detail: "푸쉬업 10개 x 3세트, 암컬, 덤벨 숄더프레스",
              alt: "물병 운동 루틴",
            },
            habit: {
              short: "1일 1정리",
              detail: "방 or 냉장고 중 1개 정리",
              alt: "정리 타이머 10분",
            },
          },
          {
            day: "목요일",
            food: {
              short: "단백질 + 곡물 위주",
              detail: `
        <strong>아침:</strong> 오트밀, 블루베리, 요거트<br>
        <strong>점심:</strong> 현미밥, 계란말이, 김<br>
        <strong>저녁:</strong> 닭가슴살 스테이크, 구운 야채
      `,
              alt: "현미밥 + 단백질볼 도시락",
            },
            exercise: {
              short: "저강도 유산소",
              detail: "실내 걷기 30분 or 자전거",
              alt: "유산소 댄스 영상",
            },
            habit: {
              short: "체형 교정 스트레칭",
              detail: "거북목, 골반 교정 동작 포함",
              alt: "SNS 루틴 따라하기",
            },
          },
          {
            day: "금요일",
            food: {
              short: "자연식 위주",
              detail: `
        <strong>아침:</strong> 사과, 견과류, 계란<br>
        <strong>점심:</strong> 생선, 나물, 잡곡밥<br>
        <strong>저녁:</strong> 구운 채소, 스무디
      `,
              alt: "클린 자연식 도시락",
            },
            exercise: {
              short: "전신 근력",
              detail: "스쿼트, 푸쉬업, 데드리프트 각 3세트",
              alt: "홈트 20분 루틴",
            },
            habit: {
              short: "소비 줄이기",
              detail: "불필요한 앱 쇼핑 금지",
              alt: "장바구니 삭제",
            },
          },
          {
            day: "토요일",
            food: {
              short: "외식 조절식",
              detail: `
        <strong>아침:</strong> 요거트, 시리얼<br>
        <strong>점심:</strong> 외식 – 절반 먹기 원칙<br>
        <strong>저녁:</strong> 샐러드, 삶은 달걀
      `,
              alt: "외식 시 덜어먹기",
            },
            exercise: {
              short: "걷기 1시간",
              detail: "쇼핑, 외출 시 많이 걷기 목표",
              alt: "만보계 8000보 이상",
            },
            habit: {
              short: "주간 정산",
              detail: "식비, 건강 점검 기록",
              alt: "노션 기록",
            },
          },
          {
            day: "일요일",
            food: {
              short: "자유식",
              detail: `
        <strong>아침:</strong> 커피, 빵류 (소량)<br>
        <strong>점심:</strong> 외식 – 좋아하는 음식 허용<br>
        <strong>저녁:</strong> 가볍게 과일 or 생략
      `,
              alt: "기분식, 단 배부르지 않게",
            },
            exercise: {
              short: "스트레칭",
              detail: "1주 마무리, 릴렉싱 요가",
              alt: "스트레칭 영상 15분",
            },
            habit: {
              short: "한 주 회고",
              detail: "좋았던 점 3가지 기록",
              alt: "회고 노트 작성",
            },
          },
        ],
        week4: [
          {
            day: "월요일",
            food: {
              short: "잡곡밥 + 단백질",
              detail: `
        <strong>아침:</strong> 고구마, 달걀 2개<br>
        <strong>점심:</strong> 잡곡밥, 된장찌개, 나물<br>
        <strong>저녁:</strong> 닭가슴살, 샐러드
      `,
              alt: "잡곡+단백질 정식 도시락",
            },
            exercise: {
              short: "하체 루틴",
              detail: "스쿼트, 런지, 브릿지 각 3세트",
              alt: "하체 유튜브 루틴",
            },
            habit: {
              short: "책 10분",
              detail: "자기계발서 1챕터 or 요약본 읽기",
              alt: "오디오북 듣기",
            },
          },
          {
            day: "화요일",
            food: {
              short: "단식 + 일반식",
              detail: `
        <strong>아침:</strong> 금식<br>
        <strong>점심:</strong> 불고기덮밥, 나물<br>
        <strong>저녁:</strong> 채소죽
      `,
              alt: "16:8 식단",
            },
            exercise: {
              short: "상체 루틴",
              detail: "푸쉬업, 암컬, 숄더프레스 각 3세트",
              alt: "가벼운 웨이트 루틴",
            },
            habit: {
              short: "일기쓰기",
              detail: "기분, 먹은 것, 배운 것 3줄씩",
              alt: "1문장 저널링",
            },
          },
          {
            day: "수요일",
            food: {
              short: "과일 + 단백질",
              detail: `
        <strong>아침:</strong> 과일샐러드, 견과류<br>
        <strong>점심:</strong> 두부덮밥, 나물<br>
        <strong>저녁:</strong> 구운 채소, 스프
      `,
              alt: "샐러드 정식",
            },
            exercise: {
              short: "요가 30분",
              detail: "전신 순환 요가, 땀 살짝",
              alt: "홈요가 앱 루틴",
            },
            habit: {
              short: "앱 정리",
              detail: "한 주 1앱 삭제 목표",
              alt: "불필요 앱 비활성화",
            },
          },
          {
            day: "목요일",
            food: {
              short: "균형잡힌 일반식",
              detail: `
        <strong>아침:</strong> 삶은 달걀, 두유<br>
        <strong>점심:</strong> 현미밥, 생선구이, 김치<br>
        <strong>저녁:</strong> 채소볶음, 미소된장국
      `,
              alt: "현미 정식 도시락",
            },
            exercise: {
              short: "유산소+근력 믹스",
              detail: "걷기 15분 + 홈트 15분",
              alt: "인터벌 유산소",
            },
            habit: {
              short: "SNS 제한",
              detail: "30분 타이머 사용, 앱 잠금",
              alt: "디지털 웰빙 모드",
            },
          },
          {
            day: "금요일",
            food: {
              short: "가벼운 클린식",
              detail: `
        <strong>아침:</strong> 고구마, 요거트<br>
        <strong>점심:</strong> 닭가슴살 샐러드<br>
        <strong>저녁:</strong> 채소죽 or 생략
      `,
              alt: "클린샐러드 도시락",
            },
            exercise: {
              short: "근지구력 루틴",
              detail: "버피, 마운틴 클라이머, 스쿼트 반복",
              alt: "인터벌 타바타",
            },
            habit: {
              short: "카페인 제한",
              detail: "점심 이후 카페인 금지",
              alt: "허브티 대체",
            },
          },
          {
            day: "토요일",
            food: {
              short: "외식 or 자유식",
              detail: `
        <strong>아침:</strong> 시리얼, 두유<br>
        <strong>점심:</strong> 외식 – 튀김류 피하기<br>
        <strong>저녁:</strong> 샐러드 or 스프
      `,
              alt: "외식 시 단백질 위주 선택",
            },
            exercise: {
              short: "스트레칭 + 걷기",
              detail: "30분 산책, 귀가 후 하체 스트레칭",
              alt: "자연 속 걷기",
            },
            habit: {
              short: "쇼핑 점검",
              detail: "이번 달 소비 리뷰 및 구매목록 확인",
              alt: "장바구니 검토",
            },
          },
          {
            day: "일요일",
            food: {
              short: "자유식 + 정리",
              detail: `
        <strong>아침:</strong> 좋아하는 음식 (소량)<br>
        <strong>점심:</strong> 외식 가능, 소식 유도<br>
        <strong>저녁:</strong> 물 섭취 후 생략 가능
      `,
              alt: "위장 휴식일",
            },
            exercise: {
              short: "릴렉싱 요가",
              detail: "긴장 풀기 중심 요가 15분",
              alt: "편안한 스트레칭",
            },
            habit: {
              short: "1개월 회고",
              detail: "식단/운동 달성률 체크 + 다음 계획",
              alt: "기록지 작성 or PDF 저장",
            },
          },
        ],
      };

      function showWeek(week) {
        document
          .querySelectorAll(".week-tabs button")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".week-tabs button")
          [week - 1].classList.add("active");
        renderTable(week);
      }
      function saveCheck(week, day, checked) {
        const key = `dietPlan_${week}_${day}`;
        localStorage.setItem(key, checked);
      }

      function loadCheck() {
        document.querySelectorAll(".day-check").forEach((chk) => {
          const week = chk.dataset.week;
          const day = chk.dataset.day;
          const saved = localStorage.getItem(`dietPlan_${week}_${day}`);
          chk.checked = saved === "true";
        });
      }

      function renderTable(week) {
        const weekPlan = plans["week" + week];
        if (!weekPlan) return;

        let html = `<table><tr><th><input disabled type="checkbox" id="all-check"></th><th>요일</th><th>식단</th><th>운동</th><th>생활습관</th></tr>`;
        for (const day of weekPlan) {
          html += `<tr onclick="showDetail('${week}', '${day.day}')">
  <td><input type="checkbox" class="day-check" data-week="${week}" data-day="${day.day}" onclick="event.stopPropagation()"></td>
  <td>${day.day}</td>
  <td>${day.food.short}</td>
  <td>${day.exercise.short}</td>
  <td>${day.habit.short}</td>
</tr>`;
        }
        html += `</table>`;
        tablesContainer.innerHTML = html;
        detailBox.style.display = "none";
        document.querySelectorAll(".day-check").forEach((chk) => {
          chk.addEventListener("change", (e) => {
            const week = e.target.dataset.week;
            const day = e.target.dataset.day;
            saveCheck(week, day, e.target.checked);
          });
        });

        loadCheck(); // 체크박스 상태 불러오기
      }

      function showDetail(week, dayName) {
        const day = plans["week" + week].find((d) => d.day === dayName);
        if (!day) return;

        detailBox.innerHTML = `
        <h3>${dayName} 상세 설명</h3>
        <strong>식단</strong><br> ${day.food.detail}<br>
        <em>대체안:</em> ${day.food.alt}<br><br>
        <strong>운동:</strong> ${day.exercise.detail}<br>
        <em>대체안:</em> ${day.exercise.alt}<br><br>
        <strong>생활습관:</strong> ${day.habit.detail}<br>
        <em>대체안:</em> ${day.habit.alt}
      `;
        detailBox.style.display = "block";
      }

      showWeek(1);
    </script>
  </body>
</html>
